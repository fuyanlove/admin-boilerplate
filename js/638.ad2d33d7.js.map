{"version":3,"file":"js/638.ad2d33d7.js","mappings":"uJAEA,SAASA,EAAcC,GACnB,OAAOC,EAAAA,EAAAA,KAAOC,IAAK,8BAA8B,CAC7CF,UAER,C,+HCHO,SAASG,EAAWC,EAAOC,EAAO,QACrC,GAAID,EAAO,CACP,GAAa,SAATC,EACA,OAAOC,IAAMF,GAAOG,OAAO,cAE/B,GAAa,SAATF,EACA,OAAOC,IAAMF,GAAOG,OAAO,YAE/B,GAAa,aAATF,EACA,OAAOC,IAAMF,GAAOG,OAAO,sBAEnC,CACJ,CAOO,SAASC,EAAYC,GACxB,MAAMC,EAAS,CAAC,EAChB,IAAK,MAAMC,KAAOF,EACG,OAAbA,EAAIE,SAA8BC,IAAbH,EAAIE,IAAmC,KAAbF,EAAIE,KACnDD,EAAOC,GAAOF,EAAIE,IAG1B,OAAOD,CACX,CAMO,SAASG,EAAUC,GACtB,OAAIA,GAGGC,EAAQ,KACnB,C,8CCvCA,MAAMC,EAAc,CAMhB,CACIC,MAAO,KACPC,KAAM,OACNC,MAAO,OAEX,CACIF,MAAO,OACPC,KAAM,YACNC,MAAO,OAEX,CACIF,MAAO,OACPC,KAAM,KACNC,MAAO,OAEX,CACIF,MAAO,aACPC,KAAM,MAEV,CACID,MAAO,KACPC,KAAM,OACNC,MAAO,MACPC,UAAYC,GACDf,IAAMe,EAAIC,MAAMf,OAAO,yBAKpCgB,EAAU,CACZ,CACIN,MAAO,KACPb,MAAO,OAEX,CACIa,MAAO,KACPb,MAAO,QAEX,CACIa,MAAO,KACPb,MAAO,OAEX,CACIa,MAAO,KACPb,MAAO,WAIf,KACIY,cACAO,U,+GCzDKC,MAAM,uB,GAIMA,MAAM,U,GAmBNA,MAAM,Y,GAYXC,EAAAA,EAAAA,GAAkC,QAA5BD,MAAM,WAAU,SAAK,G,GAO3BC,EAAAA,EAAAA,GAA4B,QAAtBD,MAAM,SAAQ,KAAC,G,+SA1CjCE,EAAAA,EAAAA,IA4FM,MA5FNC,EA4FM,EA1FFC,EAAAA,EAAAA,IA4DSC,EAAA,CA5DDL,MAAM,WAAYM,OAAQ,I,mBAC9B,IA8BS,EA9BTF,EAAAA,EAAAA,IA8BSG,EAAA,CA9BAC,GAAI,GAAKC,GAAI,GAAIT,MAAM,U,mBAC5B,IAkBM,EAlBNC,EAAAA,EAAAA,GAkBM,MAlBNS,EAkBM,EAjBFN,EAAAA,EAAAA,IAgBYO,EAAA,CAfRC,YAAY,K,WACHC,EAAAC,KAAKC,Q,qCAALF,EAAAC,KAAKC,QAAOC,GACrBC,MAAA,eACAC,WAAA,GACAC,OAAA,GACC,gBAAeC,EAAAC,aAChBC,UAAA,GACCC,QAAOH,EAAAI,O,mBAGJ,IAAwB,gBAD5BtB,EAAAA,EAAAA,IAKauB,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAJMb,EAAAc,UAARC,K,WADXC,EAAAA,EAAAA,IAKaC,EAAA,CAHR3C,IAAKyC,EAAKG,GACVtC,MAAOmC,EAAKI,SACZpD,MAAOgD,EAAKG,I,0FAIzB9B,EAAAA,EAAAA,GAMM,MANNgC,EAMM,EALF7B,EAAAA,EAAAA,IAIYO,EAAA,C,WAJQE,EAAAC,KAAKoB,O,qCAALrB,EAAAC,KAAKoB,OAAMlB,GAAEJ,YAAY,KAAKU,UAAA,I,mBACnC,IAAuB,gBAAlCpB,EAAAA,EAAAA,IAEYuB,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAFcN,EAAArB,SAAR6B,K,WAAlBC,EAAAA,EAAAA,IAEYC,EAAA,CAFwB3C,IAAKyC,EAAKhD,MAAQA,MAAOgD,EAAKhD,MAAQa,MAAOmC,EAAKnC,O,mBAClF,IAAgB,mBAAbmC,EAAKnC,OAAQ,MAAE0C,EAAAA,EAAAA,IAAGP,EAAKhD,OAAQ,KACtC,M,mEAGRwB,EAAAA,EAAAA,IAEWgC,EAAA,C,WAFQvB,EAAAC,KAAKuB,U,qCAALxB,EAAAC,KAAKuB,UAASrB,GAAEhB,MAAM,SAASY,YAAY,I,CAC/C0B,SAAOC,EAAAA,EAAAA,KAAC,IAAI,UAAJ,W,iCAG3BnC,EAAAA,EAAAA,IAeSG,EAAA,CAfAC,GAAI,GAAKC,GAAI,GAAIT,MAAM,U,mBAC5B,IAAkC,CAAlCwC,GACApC,EAAAA,EAAAA,IAKkBqC,EAAA,CAJdzC,MAAM,S,WACGa,EAAAC,KAAK4B,W,qCAAL7B,EAAAC,KAAK4B,WAAU1B,GACxB2B,KAAK,WACL/B,YAAY,U,uBAEhBgC,GACAxC,EAAAA,EAAAA,IAKkBqC,EAAA,CAJdzC,MAAM,S,WACGa,EAAAC,KAAK+B,S,qCAALhC,EAAAC,KAAK+B,SAAQ7B,GACtB2B,KAAK,WACL/B,YAAY,U,iCAIpBR,EAAAA,EAAAA,IAUSG,EAAA,CAVAC,GAAI,GAAKC,GAAI,GAAIT,MAAM,U,mBAC5B,IAQW,EARXI,EAAAA,EAAAA,IAQWgC,EAAA,C,WAPEvB,EAAAC,KAAKgC,O,qCAALjC,EAAAC,KAAKgC,OAAM9B,GACpBJ,YAAY,wBACZZ,MAAM,UACL+C,SAAKC,EAAAA,EAAAA,IAAQ5B,EAAA6B,SAAQ,WACtB3B,UAAA,I,CAEWgB,SAAOC,EAAAA,EAAAA,KAAC,IAAE,UAAF,S,yEAK/BV,EAAAA,EAAAA,IAkBWqB,EAAA,CAlBAC,KAAMtC,EAAAsC,KAAMC,OAAA,GAA2BC,OAAA,I,mBAC9C,IAKkB,EALlBjD,EAAAA,EAAAA,IAKkBkD,EAAA,CALD7D,MAAM,KAAKC,KAAK,UAAU,aAAW,aAAaC,MAAM,MAAM,4B,CAChE4D,SAAOhB,EAAAA,EAAAA,KAEd,EAFkB1C,SAAG,CAETA,EAAI2D,YAAS,WAAzBtD,EAAAA,EAAAA,IAA6E,OAAAuD,GAAAtB,EAAAA,EAAAA,IAA/CtC,EAAI2D,UAAUxB,UAAYnC,EAAIkB,SAAO,uB,qBAG3Eb,EAAAA,EAAAA,IAUkBuB,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IATGN,EAAA5B,aAAVkE,K,WADX7B,EAAAA,EAAAA,IAUkByB,EAAA,CARbnE,IAAKuE,EAAOhE,KACZD,MAAOiE,EAAOjE,MACdC,KAAMgE,EAAOhE,KACbC,MAAO+D,EAAO/D,O,CAEJ4D,SAAOhB,EAAAA,EAAAA,KACd,EADkB1C,SAAG,mBAClB6D,EAAO9D,UAAY8D,EAAO9D,UAAUC,GAAOA,EAAI6D,EAAOhE,OAAI,M,sEAfhCmB,EAAA8C,WAoB/B9C,EAAAsC,KAAKS,SAAM,WADrB/B,EAAAA,EAAAA,IAQiBgC,EAAA,C,MANb7D,MAAM,eACE8D,YAAajD,EAAAkD,WAAWC,K,sCAAXnD,EAAAkD,WAAWC,KAAIhD,GACpCiD,WAAA,GACQC,SAAUrD,EAAAkD,WAAWI,M,mCAAXtD,EAAAkD,WAAWI,MAAKnD,GAClCoD,OAAO,oBACNC,MAAOxD,EAAAkD,WAAWM,O,0GAU/B,GACIC,KAAM,YACNnB,IAAAA,GACI,MAAO,CACHrC,KAAM,CACFgC,OAAQ,GACRZ,OAAQ,GACRQ,WAAY,GACZG,SAAU,GACVR,UAAW,GACXtB,QAAS,IAGb4C,SAAS,EACTR,KAAM,GAENY,WAAY,CACRC,KAAM,EACNG,MAAO,GACPE,MAAO,GAGX1C,SAAU,GAElB,EACA4C,SAAU,CACN/E,WAAAA,GACI,OAAOgF,EAAAA,EAAUhF,WACrB,EACAO,OAAAA,GACI,OAAOyE,EAAAA,EAAUzE,OACrB,EACAvB,MAAAA,GACI,OAAOQ,EAAAA,EAAAA,IAAY,CACf8D,OAAQ2B,KAAK3D,KAAKgC,OAClBZ,OAAQuC,KAAK3D,KAAKoB,OAClBQ,WAAY+B,KAAK3D,KAAK4B,WACtBG,SAAU4B,KAAK3D,KAAK+B,SACpBR,UAAWoC,KAAK3D,KAAKuB,UACrBtB,QAAS0D,KAAK3D,KAAKC,QACnBiD,KAAMS,KAAKV,WAAWC,KACtBG,MAAOM,KAAKV,WAAWI,OAE/B,GAEJO,MAAO,CACHlG,OAAQ,CACJmG,OAAAA,GACIF,KAAKxB,UACT,EACA2B,MAAM,EACNC,WAAW,IAGnB9E,QAAS,CACLkD,SAAU,WACNwB,KAAKd,SAAU,GACfpF,EAAAA,EAAAA,GAAckG,KAAKjG,QACdsG,MAAMC,IACHN,KAAKtB,KAAO4B,EAAI5B,KAAKA,KAAK6B,MAAQ,GAClCP,KAAKV,WAAWM,MAAQU,EAAI5B,KAAKA,KAAKkB,OAAS,CAAC,IAEnDY,SAAQ,KACLR,KAAKd,SAAU,CAAK,GAEhC,EACAtC,YAAAA,CAAa6D,GACU,IAAfA,EAAItB,QAIRuB,EAAAA,EAAAA,IAAe,CACXrC,OAAQoC,EACRlB,KAAM,EACNG,MAAO,KACRW,MAAMC,IACLN,KAAK9C,SAAWoD,EAAI5B,KAAKA,KAAK6B,MAAQ,EAAE,IARxCP,KAAK9C,SAAW,EAUxB,EACAH,KAAAA,GACIiD,KAAK9C,SAAW,EACpB,I,UC/KR,MAAMyD,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://admin/./src/service/system.js","webpack://admin/./src/utils/index.js","webpack://admin/./src/views/system/action-log.js","webpack://admin/./src/views/system/action-log.vue","webpack://admin/./src/views/system/action-log.vue?b293"],"sourcesContent":["import { $cms } from \"@/utils/https.js\";\n\nfunction getActionLogs(params) {\n    return $cms().get(`/api/cms/system/action/logs`, {\n        params,\n    });\n}\n\nexport { getActionLogs };\n","import dayjs from \"dayjs\";\nimport { ElNotification } from \"element-plus\";\n\nexport function formatDate(value, mode = \"date\") {\n    if (value) {\n        if (mode === \"date\") {\n            return dayjs(value).format(\"YYYY-MM-DD\");\n        }\n        if (mode === \"time\") {\n            return dayjs(value).format(\"HH:mm:ss\");\n        }\n        if (mode === \"datetime\") {\n            return dayjs(value).format(\"YYYY-MM-DD HH:mm:ss\");\n        }\n    }\n}\n\n/**\n * 去除对象空值\n * @param {*} obj\n * @returns\n */\nexport function removeEmpty(obj) {\n    const newObj = {};\n    for (const key in obj) {\n        if (obj[key] !== null && obj[key] !== undefined && obj[key] !== \"\") {\n            newObj[key] = obj[key];\n        }\n    }\n    return newObj;\n}\n\n/**\n * 头像地址\n * @param {*} url\n */\nexport function avatarUrl(url) {\n    if (url) {\n        return url;\n    }\n    return require(\"../assets/img/common/logo.svg\");\n}\n\n/**\n * 复制文本\n */\nexport function copyText(text) {\n    if (navigator.clipboard) {\n        navigator.clipboard.writeText(text);\n        ElNotification({\n            title: \"复制成功\",\n            message: text,\n            type: \"success\",\n        });\n    } else {\n        const input = document.createElement(\"input\");\n        input.value = text;\n        document.body.appendChild(input);\n        input.select();\n        document.execCommand(\"copy\");\n        document.body.removeChild(input);\n        ElNotification({\n            title: \"复制成功\",\n            message: text,\n            type: \"success\",\n        });\n    }\n}\n","import dayjs from \"dayjs\";\n\nconst tableHeader = [\n    // {\n    //     label: \"用户\",\n    //     prop: \"user_id\",\n    //     width: \"100\",\n    // },\n    {\n        label: \"描述\",\n        prop: \"desc\",\n        width: \"200\",\n    },\n    {\n        label: \"资源ID\",\n        prop: \"source_id\",\n        width: \"100\",\n    },\n    {\n        label: \"IP地址\",\n        prop: \"ip\",\n        width: \"100\",\n    },\n    {\n        label: \"User Agent\",\n        prop: \"ua\",\n    },\n    {\n        label: \"时间\",\n        prop: \"time\",\n        width: \"200\",\n        formatter: (row) => {\n            return dayjs(row.time).format(\"YYYY-MM-DD HH:mm:ss\");\n        },\n    },\n];\n\nconst methods = [\n    {\n        label: \"查询\",\n        value: \"GET\",\n    },\n    {\n        label: \"创建\",\n        value: \"POST\",\n    },\n    {\n        label: \"更新\",\n        value: \"PUT\",\n    },\n    {\n        label: \"删除\",\n        value: \"DELETE\",\n    },\n];\n\nexport default {\n    tableHeader,\n    methods,\n};\n","<template>\n    <div class=\"p-action-log c-main\">\n        <!-- 标题和添加按钮 -->\n        <el-row class=\"m-search\" :gutter=\"20\">\n            <el-col :xs=\"24\" :md=\"12\" class=\"u-info\">\n                <div class=\"u-user\">\n                    <el-select\n                        placeholder=\"用户\"\n                        v-model=\"form.user_id\"\n                        style=\"width: 100%\"\n                        filterable\n                        remote\n                        :remote-method=\"remoteMethod\"\n                        clearable\n                        @clear=\"clear\"\n                    >\n                        <el-option\n                            v-for=\"item in userList\"\n                            :key=\"item.id\"\n                            :label=\"item.username\"\n                            :value=\"item.id\"\n                        ></el-option>\n                    </el-select>\n                </div>\n                <div class=\"u-action\">\n                    <el-select v-model=\"form.method\" placeholder=\"动作\" clearable>\n                        <el-option v-for=\"item in methods\" :key=\"item.value\" :value=\"item.value\" :label=\"item.label\">\n                            {{ item.label }} ({{ item.value }})\n                        </el-option>\n                    </el-select>\n                </div>\n                <el-input v-model=\"form.source_id\" class=\"u-user\" placeholder=\"\">\n                    <template #prepend>资源ID</template>\n                </el-input>\n            </el-col>\n            <el-col :xs=\"24\" :md=\"12\" class=\"u-time\">\n                <span class=\"u-label\">时间范围：</span>\n                <el-date-picker\n                    class=\"u-date\"\n                    v-model=\"form.start_time\"\n                    type=\"datetime\"\n                    placeholder=\"选择开始时间\"\n                ></el-date-picker>\n                <span class=\"u-div\">-</span>\n                <el-date-picker\n                    class=\"u-date\"\n                    v-model=\"form.end_time\"\n                    type=\"datetime\"\n                    placeholder=\"选择结束时间\"\n                ></el-date-picker>\n            </el-col>\n\n            <el-col :xs=\"24\" :md=\"24\" class=\"u-info\">\n                <el-input\n                    v-model=\"form.search\"\n                    placeholder=\"从IP／用户代理(UA)／描述／路径中检索\"\n                    class=\"u-input\"\n                    @keyup.enter=\"loadData\"\n                    clearable\n                >\n                    <template #prepend>搜索</template>\n                </el-input>\n            </el-col>\n        </el-row>\n        <!-- 数据表格 -->\n        <el-table :data=\"data\" border v-loading=\"loading\" stripe>\n            <el-table-column label=\"用户\" prop=\"user_id\" class-name=\"u-username\" width=\"150\" show-overflow-tooltip>\n                <template #default=\"{ row }\">\n                    <!-- <img class=\"u-avatar\" v-if=\"row.user_info\" :src=\"avatarUrl(row.user_info.avatar)\" :alt=\"row.user_info.username\" /> -->\n                    <span v-if=\"row.user_info\">{{ row.user_info.username || row.user_id }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column\n                v-for=\"header in tableHeader\"\n                :key=\"header.prop\"\n                :label=\"header.label\"\n                :prop=\"header.prop\"\n                :width=\"header.width\"\n            >\n                <template #default=\"{ row }\">\n                    {{ header.formatter ? header.formatter(row) : row[header.prop] }}\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            v-if=\"data.length\"\n            class=\"m-pagination\"\n            v-model:currentPage=\"pagination.page\"\n            background\n            v-model:pageSize=\"pagination.limit\"\n            layout=\"prev, pager, next\"\n            :total=\"pagination.total\"\n        ></el-pagination>\n    </div>\n</template>\n\n<script>\nimport { getActionLogs } from \"@/service/system\";\nimport { getAccountList } from \"@/service/account\";\nimport actionLog from \"./action-log\";\nimport { removeEmpty } from \"@/utils\";\nexport default {\n    name: \"ActionLog\",\n    data() {\n        return {\n            form: {\n                search: \"\",\n                method: \"\",\n                start_time: \"\",\n                end_time: \"\",\n                source_id: \"\",\n                user_id: \"\",\n            },\n\n            loading: false,\n            data: [],\n\n            pagination: {\n                page: 1,\n                limit: 10,\n                total: 0,\n            },\n\n            userList: [],\n        };\n    },\n    computed: {\n        tableHeader() {\n            return actionLog.tableHeader;\n        },\n        methods() {\n            return actionLog.methods;\n        },\n        params() {\n            return removeEmpty({\n                search: this.form.search,\n                method: this.form.method,\n                start_time: this.form.start_time,\n                end_time: this.form.end_time,\n                source_id: this.form.source_id,\n                user_id: this.form.user_id,\n                page: this.pagination.page,\n                limit: this.pagination.limit,\n            });\n        },\n    },\n    watch: {\n        params: {\n            handler() {\n                this.loadData();\n            },\n            deep: true,\n            immediate: true,\n        },\n    },\n    methods: {\n        loadData: function () {\n            this.loading = true;\n            getActionLogs(this.params)\n                .then((res) => {\n                    this.data = res.data.data.list || [];\n                    this.pagination.total = res.data.data.total || 0;\n                })\n                .finally(() => {\n                    this.loading = false;\n                });\n        },\n        remoteMethod(val) {\n            if (val.length === 0) {\n                this.userList = [];\n                return;\n            }\n            getAccountList({\n                search: val,\n                page: 1,\n                limit: 10,\n            }).then((res) => {\n                this.userList = res.data.data.list || [];\n            });\n        },\n        clear() {\n            this.userList = [];\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"@/assets/css/views/system/action-log.less\";\n</style>\n","import { render } from \"./action-log.vue?vue&type=template&id=58c08e7d\"\nimport script from \"./action-log.vue?vue&type=script&lang=js\"\nexport * from \"./action-log.vue?vue&type=script&lang=js\"\n\nimport \"./action-log.vue?vue&type=style&index=0&id=58c08e7d&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["getActionLogs","params","$cms","get","formatDate","value","mode","dayjs","format","removeEmpty","obj","newObj","key","undefined","avatarUrl","url","require","tableHeader","label","prop","width","formatter","row","time","methods","class","_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_el_row","gutter","_component_el_col","xs","md","_hoisted_2","_component_el_select","placeholder","$data","form","user_id","$event","style","filterable","remote","$options","remoteMethod","clearable","onClear","clear","_Fragment","_renderList","userList","item","_createBlock","_component_el_option","id","username","_hoisted_3","method","_toDisplayString","_component_el_input","source_id","prepend","_withCtx","_hoisted_4","_component_el_date_picker","start_time","type","_hoisted_5","end_time","search","onKeyup","_withKeys","loadData","_component_el_table","data","border","stripe","_component_el_table_column","default","user_info","_hoisted_6","header","loading","length","_component_el_pagination","currentPage","pagination","page","background","pageSize","limit","layout","total","name","computed","actionLog","this","watch","handler","deep","immediate","then","res","list","finally","val","getAccountList","__exports__","render"],"sourceRoot":""}