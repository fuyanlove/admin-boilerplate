{"version":3,"file":"js/757.a7b01700.js","mappings":"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","sources":["webpack://admin/./src/service/system.js","webpack://admin/./src/utils/index.js","webpack://admin/./src/views/system/action-log.js","webpack://admin/./src/views/system/user-action-log.vue","webpack://admin/./src/views/system/user-action-log.vue?72f4"],"sourcesContent":["import { $cms } from \"@/utils/https.js\";\n\nfunction getActionLogs(params) {\n    return $cms().get(`/api/cms/system/action/logs`, {\n        params,\n    });\n}\n\nexport { getActionLogs };\n","import dayjs from \"dayjs\";\nimport { ElNotification } from \"element-plus\";\n\nexport function formatDate(value, mode = \"date\") {\n    if (value) {\n        if (mode === \"date\") {\n            return dayjs(value).format(\"YYYY-MM-DD\");\n        }\n        if (mode === \"time\") {\n            return dayjs(value).format(\"HH:mm:ss\");\n        }\n        if (mode === \"datetime\") {\n            return dayjs(value).format(\"YYYY-MM-DD HH:mm:ss\");\n        }\n    }\n}\n\n/**\n * 去除对象空值\n * @param {*} obj\n * @returns\n */\nexport function removeEmpty(obj) {\n    const newObj = {};\n    for (const key in obj) {\n        if (obj[key] !== null && obj[key] !== undefined && obj[key] !== \"\") {\n            newObj[key] = obj[key];\n        }\n    }\n    return newObj;\n}\n\n/**\n * 头像地址\n * @param {*} url\n */\nexport function avatarUrl(url) {\n    if (url) {\n        return url;\n    }\n    return require(\"../assets/img/common/logo.svg\");\n}\n\n/**\n * 复制文本\n */\nexport function copyText(text) {\n    if (navigator.clipboard) {\n        navigator.clipboard.writeText(text);\n        ElNotification({\n            title: \"复制成功\",\n            message: text,\n            type: \"success\",\n        });\n    } else {\n        const input = document.createElement(\"input\");\n        input.value = text;\n        document.body.appendChild(input);\n        input.select();\n        document.execCommand(\"copy\");\n        document.body.removeChild(input);\n        ElNotification({\n            title: \"复制成功\",\n            message: text,\n            type: \"success\",\n        });\n    }\n}\n","import dayjs from \"dayjs\";\n\nconst tableHeader = [\n    // {\n    //     label: \"用户\",\n    //     prop: \"user_id\",\n    //     width: \"100\",\n    // },\n    {\n        label: \"描述\",\n        prop: \"desc\",\n        width: \"200\",\n    },\n    {\n        label: \"资源ID\",\n        prop: \"source_id\",\n        width: \"100\",\n    },\n    {\n        label: \"IP地址\",\n        prop: \"ip\",\n        width: \"100\",\n    },\n    {\n        label: \"User Agent\",\n        prop: \"ua\",\n    },\n    {\n        label: \"时间\",\n        prop: \"time\",\n        width: \"200\",\n        formatter: (row) => {\n            return dayjs(row.time).format(\"YYYY-MM-DD HH:mm:ss\");\n        },\n    },\n];\n\nconst methods = [\n    {\n        label: \"查询\",\n        value: \"GET\",\n    },\n    {\n        label: \"创建\",\n        value: \"POST\",\n    },\n    {\n        label: \"更新\",\n        value: \"PUT\",\n    },\n    {\n        label: \"删除\",\n        value: \"DELETE\",\n    },\n];\n\nexport default {\n    tableHeader,\n    methods,\n};\n","<template>\n    <div class=\"p-action-log c-main\">\n        <!-- 标题和添加按钮 -->\n        <el-row class=\"m-search\" :gutter=\"20\">\n            <el-col :xs=\"24\" :md=\"12\" class=\"u-info\">\n                <div class=\"u-user\">\n                    <el-select\n                        placeholder=\"用户\"\n                        v-model=\"form.user_id\"\n                        style=\"width: 100%\"\n                        filterable\n                        remote\n                        :remote-method=\"remoteMethod\"\n                        clearable\n                    >\n                        <el-option\n                            v-for=\"item in userList\"\n                            :key=\"item.id\"\n                            :label=\"item.wechat_name + ' (' + item.name + ')'\"\n                            :value=\"item.id\"\n                        ></el-option>\n                    </el-select>\n                </div>\n                <div class=\"u-action\">\n                    <el-select v-model=\"form.method\" placeholder=\"动作\" clearable>\n                        <el-option v-for=\"item in methods\" :key=\"item.value\" :value=\"item.value\" :label=\"item.label\">\n                            {{ item.label }} ({{ item.value }})\n                        </el-option>\n                    </el-select>\n                </div>\n                <el-input v-model=\"form.source_id\" class=\"u-user\" placeholder=\"\">\n                    <template #prepend>资源ID</template>\n                </el-input>\n            </el-col>\n            <el-col :xs=\"24\" :md=\"12\" class=\"u-time\">\n                <span class=\"u-label\">时间范围：</span>\n                <el-date-picker\n                    class=\"u-date\"\n                    v-model=\"form.start_time\"\n                    type=\"datetime\"\n                    placeholder=\"选择开始时间\"\n                ></el-date-picker>\n                <span class=\"u-div\">-</span>\n                <el-date-picker\n                    class=\"u-date\"\n                    v-model=\"form.end_time\"\n                    type=\"datetime\"\n                    placeholder=\"选择结束时间\"\n                ></el-date-picker>\n            </el-col>\n\n            <el-col :xs=\"24\" :md=\"24\" class=\"u-info\">\n                <el-input\n                    v-model=\"form.search\"\n                    placeholder=\"从IP／用户代理(UA)／描述／路径中检索\"\n                    class=\"u-input\"\n                    @keyup.enter=\"loadData\"\n                    clearable\n                >\n                    <template #prepend>搜索</template>\n                </el-input>\n            </el-col>\n        </el-row>\n        <!-- 数据表格 -->\n        <el-table :data=\"data\" border v-loading=\"loading\" stripe>\n            <el-table-column label=\"用户\" prop=\"user_id\" class-name=\"u-username\" width=\"150\" show-overflow-tooltip>\n                <template #default=\"{ row }\">\n                    <!-- <img class=\"u-avatar\" v-if=\"row.user_info\" :src=\"avatarUrl(row.user_info.avatar)\" :alt=\"row.user_info.username\" /> -->\n                    <span v-if=\"row.user\">{{ row.user.wechat_name || row.user.name || row.user_id }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column\n                v-for=\"header in tableHeader\"\n                :key=\"header.prop\"\n                :label=\"header.label\"\n                :prop=\"header.prop\"\n                :width=\"header.width\"\n                show-overflow-tooltip\n                :tooltip-options=\"{ 'popper-class': 'u-table-tooltip' }\"\n            >\n                <template #default=\"{ row }\">\n                    {{ header.formatter ? header.formatter(row) : row[header.prop] }}\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            v-if=\"data.length\"\n            class=\"m-pagination\"\n            v-model:currentPage=\"pagination.page\"\n            background\n            v-model:pageSize=\"pagination.limit\"\n            layout=\"prev, pager, next\"\n            :total=\"pagination.total\"\n        ></el-pagination>\n    </div>\n</template>\n\n<script>\nimport { getActionLogs } from \"@/service/system\";\nimport { getAccountList } from \"@/service/account\";\nimport actionLog from \"./action-log\";\nimport { removeEmpty, avatarUrl } from \"@/utils\";\nexport default {\n    name: \"ActionLog\",\n    data() {\n        return {\n            form: {\n                search: \"\",\n                method: \"\",\n                start_time: \"\",\n                end_time: \"\",\n                source_id: \"\",\n                user_id: \"\",\n            },\n\n            loading: false,\n            data: [],\n\n            pagination: {\n                page: 1,\n                limit: 15,\n                total: 0,\n            },\n\n            userList: [],\n        };\n    },\n    computed: {\n        tableHeader() {\n            return actionLog.tableHeader;\n        },\n        methods() {\n            return actionLog.methods;\n        },\n        params() {\n            return removeEmpty({\n                search: this.form.search,\n                method: this.form.method,\n                start_time: this.form.start_time,\n                end_time: this.form.end_time,\n                source_id: this.form.source_id,\n                user_id: this.form.user_id,\n            });\n        },\n        reset_params() {\n            return [\n                this.form.search,\n                this.form.method,\n                this.form.start_time,\n                this.form.end_time,\n                this.form.source_id,\n                this.form.user_id,\n            ];\n        },\n        page_params() {\n            return {\n                page: this.pagination.page,\n                limit: this.pagination.limit,\n            };\n        },\n    },\n    watch: {\n        reset_params: {\n            handler() {\n                this.pagination.page = 1;\n            },\n            deep: true,\n        },\n        params: {\n            handler() {\n                this.loadData();\n            },\n            deep: true,\n            immediate: true,\n        },\n        page_params: {\n            handler() {\n                this.loadData();\n            },\n            deep: true,\n        },\n    },\n    methods: {\n        avatarUrl,\n        loadData: function () {\n            this.loading = true;\n            getActionLogs({ ...this.params, ...this.page_params })\n                .then((res) => {\n                    this.data = res.data.data.list || [];\n                    this.pagination.total = res.data.data.total || 0;\n                })\n                .finally(() => {\n                    this.loading = false;\n                });\n        },\n        remoteMethod(val) {\n            getAccountList({\n                search: val,\n                page: 1,\n                limit: 10,\n            }).then((res) => {\n                this.userList = res.data.data.list || [];\n            });\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"@/assets/css/views/system/action-log.less\";\n</style>\n","import { render } from \"./user-action-log.vue?vue&type=template&id=721ccb80\"\nimport script from \"./user-action-log.vue?vue&type=script&lang=js\"\nexport * from \"./user-action-log.vue?vue&type=script&lang=js\"\n\nimport \"./user-action-log.vue?vue&type=style&index=0&id=721ccb80&lang=less\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["getActionLogs","params","$cms","get","formatDate","value","mode","dayjs","format","removeEmpty","obj","newObj","key","undefined","avatarUrl","url","require","tableHeader","label","prop","width","formatter","row","time","methods","class","_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_el_row","gutter","_component_el_col","xs","md","_hoisted_2","_component_el_select","placeholder","$data","form","user_id","$event","style","filterable","remote","$options","remoteMethod","clearable","_Fragment","_renderList","userList","item","_createBlock","_component_el_option","id","wechat_name","name","_hoisted_3","method","_toDisplayString","_component_el_input","source_id","prepend","_withCtx","_hoisted_4","_component_el_date_picker","start_time","type","_hoisted_5","end_time","search","onKeyup","_withKeys","loadData","_component_el_table","data","border","stripe","_component_el_table_column","default","user","_hoisted_6","header","loading","length","_component_el_pagination","currentPage","pagination","page","background","pageSize","limit","layout","total","computed","actionLog","this","reset_params","page_params","watch","handler","deep","immediate","then","res","list","finally","val","getAccountList","__exports__","render"],"sourceRoot":""}